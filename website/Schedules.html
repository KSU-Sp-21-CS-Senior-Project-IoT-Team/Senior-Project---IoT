<!DOCTYPE html>
<html>

<head>
	<link rel="stylesheet" href="style.css">
</head>

<div class="topnav">
	<a href="index.html">Home</a>
	<a href="login.html">Login</a>
	<!--<a href="Device_Registration.html">Registration</a>-->
	<a href="Device_Management.html">Device Management</a></div>

<h1> Current Temperature Setting:
</h1>


<p class="inline">TEMPERATURE: </p>
<p class="inline" id="currentTemp"></p>
<p class="inline">	&#8457;</p>
<br>
<p class="inline">MODE: </p>
<p class="inline" id="currentMode"></p>

<h1>Set Thermostat:
</h1>
<!--
Date: <select name="month" id="month">
                <option value="January" selected="selected">Month</option>
              </select>
              <select name="day" id="day">
                    <option value="January" selected="selected">Day</option>
                  </select>
              <select name="year" id="year">
                    <option value="January" selected="selected">Year</option>
                    </select>
        <br>
       
        <br><br>
		-->
<input type="checkbox" id="budgetMode" name="budgetMode" onclick="setBudget()">
<label for="budgetMode">Enable Budget Mode?</label>

<div id="budgetSettings" style="display:none">
<form>
  <br>
  <label for="maxTemp">Maximum Temperature:</label><br>
  <input type="text" id="maxTemp" name="maxTemp"><br><br>
  <label for="minTemp">Minimum Temperature:</label><br>
  <input type="text" id="minTemp" name="minTemp"><br><br>
  <label for="threshTemp">Threshold Temperature:</label><br>
  <input type="text" id="threshTemp" name="threshTemp">
</form><br>
</div>

<div id="settings" style="display:block">
<form>
  <br>
  <label for="temp">Enter Temperature:</label><br>
  <input type="text" id="temp" name="temp"><br>
</form><br>
</div>

<input type="submit" value="Submit" onclick="scheduleFunction()">  
<!--<div class="dropdown">
        <button class="dropbtn">Time</button>
        <div class="dropdown-content">
        <a href="1">Link 1</a>
        <a href="#">Link 2</a>
        <a href="#">Link 3</a>
		
        </div>
      </div>-->
    <!--    
<h1>Current Schedule:
</h1>
-->

<!--<ul id="list"><ul>-->

                    <script>
                            CurrentTemperature();
                            var dateObject = {
                              "January": {
                                "1":[2021],  "2":[2021], "3":[2021], "4":[2021], "5":[2021], "6":[2021], "7":[2021], "8":[2021], "9":[2021], "10":[2021],"11":[2021],"12":[2021] ,"13":[2021] ,"14":[2021] ,"15":[2021] ,"16":[2021] ,"17":[2021] ,"18":[2021] ,"19":[2021] ,"20":[2021] ,"21":[2021] ,"22":[2021] ,"23":[2021] ,"24":[2021] ,"25":[2021] ,"26":[2021] ,"27":[2021] ,"28":[2021] ,"29":[2021] ,"30":[2021] ,"31":[2021] 
                              },
                              "February": {
                                "1":[2021],  "2":[2021], "3":[2021], "4":[2021], "5":[2021], "6":[2021], "7":[2021], "8":[2021], "9":[2021], "10":[2021],"11":[2021],"12":[2021] ,"13":[2021] ,"14":[2021] ,"15":[2021] ,"16":[2021] ,"17":[2021] ,"18":[2021] ,"19":[2021] ,"20":[2021] ,"21":[2021] ,"22":[2021] ,"23":[2021] ,"24":[2021] ,"25":[2021] ,"26":[2021] ,"27":[2021] ,"28":[2021] ,"29":[2021] ,"30":[2021] ,"31":[2021]
                              },
                              "March": {
                                "1":[2021],  "2":[2021], "3":[2021], "4":[2021], "5":[2021], "6":[2021], "7":[2021], "8":[2021], "9":[2021], "10":[2021],"11":[2021],"12":[2021] ,"13":[2021] ,"14":[2021] ,"15":[2021] ,"16":[2021] ,"17":[2021] ,"18":[2021] ,"19":[2021] ,"20":[2021] ,"21":[2021] ,"22":[2021] ,"23":[2021] ,"24":[2021] ,"25":[2021] ,"26":[2021] ,"27":[2021] ,"28":[2021] ,"29":[2021] ,"30":[2021] ,"31":[2021] 
                              },

                              "April": {
                                "1":[2021],  "2":[2021], "3":[2021], "4":[2021], "5":[2021], "6":[2021], "7":[2021], "8":[2021], "9":[2021], "10":[2021],"11":[2021],"12":[2021] ,"13":[2021] ,"14":[2021] ,"15":[2021] ,"16":[2021] ,"17":[2021] ,"18":[2021] ,"19":[2021] ,"20":[2021] ,"21":[2021] ,"22":[2021] ,"23":[2021] ,"24":[2021] ,"25":[2021] ,"26":[2021] ,"27":[2021] ,"28":[2021] ,"29":[2021] ,"30":[2021] ,"31":[2021] 
                              },

                              "May": {
                                "1":[2021],  "2":[2021], "3":[2021], "4":[2021], "5":[2021], "6":[2021], "7":[2021], "8":[2021], "9":[2021], "10":[2021],"11":[2021],"12":[2021] ,"13":[2021] ,"14":[2021] ,"15":[2021] ,"16":[2021] ,"17":[2021] ,"18":[2021] ,"19":[2021] ,"20":[2021] ,"21":[2021] ,"22":[2021] ,"23":[2021] ,"24":[2021] ,"25":[2021] ,"26":[2021] ,"27":[2021] ,"28":[2021] ,"29":[2021] ,"30":[2021] ,"31":[2021] 
                              },

                              "June": {
                                "1":[2021],  "2":[2021], "3":[2021], "4":[2021], "5":[2021], "6":[2021], "7":[2021], "8":[2021], "9":[2021], "10":[2021],"11":[2021],"12":[2021] ,"13":[2021] ,"14":[2021] ,"15":[2021] ,"16":[2021] ,"17":[2021] ,"18":[2021] ,"19":[2021] ,"20":[2021] ,"21":[2021] ,"22":[2021] ,"23":[2021] ,"24":[2021] ,"25":[2021] ,"26":[2021] ,"27":[2021] ,"28":[2021] ,"29":[2021] ,"30":[2021] ,"31":[2021] 
                              },

                              "July": {
                                "1":[2021],  "2":[2021], "3":[2021], "4":[2021], "5":[2021], "6":[2021], "7":[2021], "8":[2021], "9":[2021], "10":[2021],"11":[2021],"12":[2021] ,"13":[2021] ,"14":[2021] ,"15":[2021] ,"16":[2021] ,"17":[2021] ,"18":[2021] ,"19":[2021] ,"20":[2021] ,"21":[2021] ,"22":[2021] ,"23":[2021] ,"24":[2021] ,"25":[2021] ,"26":[2021] ,"27":[2021] ,"28":[2021] ,"29":[2021] ,"30":[2021] ,"31":[2021] 
                              },


                              "August": {
                                "1":[2021],  "2":[2021], "3":[2021], "4":[2021], "5":[2021], "6":[2021], "7":[2021], "8":[2021], "9":[2021], "10":[2021],"11":[2021],"12":[2021] ,"13":[2021] ,"14":[2021] ,"15":[2021] ,"16":[2021] ,"17":[2021] ,"18":[2021] ,"19":[2021] ,"20":[2021] ,"21":[2021] ,"22":[2021] ,"23":[2021] ,"24":[2021] ,"25":[2021] ,"26":[2021] ,"27":[2021] ,"28":[2021] ,"29":[2021] ,"30":[2021] ,"31":[2021] 
                              },


                              "September": {
                                "1":[2021],  "2":[2021], "3":[2021], "4":[2021], "5":[2021], "6":[2021], "7":[2021], "8":[2021], "9":[2021], "10":[2021],"11":[2021],"12":[2021] ,"13":[2021] ,"14":[2021] ,"15":[2021] ,"16":[2021] ,"17":[2021] ,"18":[2021] ,"19":[2021] ,"20":[2021] ,"21":[2021] ,"22":[2021] ,"23":[2021] ,"24":[2021] ,"25":[2021] ,"26":[2021] ,"27":[2021] ,"28":[2021] ,"29":[2021] ,"30":[2021] ,"31":[2021] 
                              },


                              "October": {
                                "1":[2021],  "2":[2021], "3":[2021], "4":[2021], "5":[2021], "6":[2021], "7":[2021], "8":[2021], "9":[2021], "10":[2021],"11":[2021],"12":[2021] ,"13":[2021] ,"14":[2021] ,"15":[2021] ,"16":[2021] ,"17":[2021] ,"18":[2021] ,"19":[2021] ,"20":[2021] ,"21":[2021] ,"22":[2021] ,"23":[2021] ,"24":[2021] ,"25":[2021] ,"26":[2021] ,"27":[2021] ,"28":[2021] ,"29":[2021] ,"30":[2021] ,"31":[2021] 
                              },


                              "November": {
                                "1":[2021],  "2":[2021], "3":[2021], "4":[2021], "5":[2021], "6":[2021], "7":[2021], "8":[2021], "9":[2021], "10":[2021],"11":[2021],"12":[2021] ,"13":[2021] ,"14":[2021] ,"15":[2021] ,"16":[2021] ,"17":[2021] ,"18":[2021] ,"19":[2021] ,"20":[2021] ,"21":[2021] ,"22":[2021] ,"23":[2021] ,"24":[2021] ,"25":[2021] ,"26":[2021] ,"27":[2021] ,"28":[2021] ,"29":[2021] ,"30":[2021] ,"31":[2021] 
                              },


                              "December": {
                                "1":[2021],  "2":[2021], "3":[2021], "4":[2021], "5":[2021], "6":[2021], "7":[2021], "8":[2021], "9":[2021], "10":[2021],"11":[2021],"12":[2021] ,"13":[2021] ,"14":[2021] ,"15":[2021] ,"16":[2021] ,"17":[2021] ,"18":[2021] ,"19":[2021] ,"20":[2021] ,"21":[2021] ,"22":[2021] ,"23":[2021] ,"24":[2021] ,"25":[2021] ,"26":[2021] ,"27":[2021] ,"28":[2021] ,"29":[2021] ,"30":[2021] ,"31":[2021] 
                              },


                            }
                            var timeObject = {
                              "12:00 PM": {},"12:30 PM": {},"1:00 PM": {},
                              "1:30 PM": {},"2:00 PM": {},"2:30 PM": {},
                              "3:30 PM": {},"4:30 PM": {},"5:00 PM": {},
                              "5:30 PM": {},"6:00 PM": {},"6:30 PM": {},
                              "7:00 PM": {},"7:30 PM": {},"8:00 PM": {},
                              "8:30 PM": {},"9:00 PM": {},"9:30 PM": {},
                              "10:00 PM": {},"10:30 PM": {},"11:00 PM": {},
                              "11:30 PM": {},"12:00 AM": {},"12:30 AM": {},
                              "1:00 AM": {},"1:30 AM": {},"2:00 AM": {},
                              "2:30 AM": {},"3:30 AM": {},"4:30 AM": {},
                              "5:00 AM": {},"5:30 AM": {},"6:00 AM": {},
                              "6:30 AM": {},"7:00 AM": {},"7:30 AM": {},
                              "8:00 AM": {},"8:30 AM": {},"9:00 AM": {},
                              "9:30 AM": {},"10:00 AM": {},"10:30 AM": {},
                              "11:00 AM": {},"11:30 AM": {}
                            }
                            
                            window.onload = function() {
                              var monthSel = document.getElementById("month");
                              var daySel = document.getElementById("day");
                              var yearSel = document.getElementById("year");
                              var timeSel = document.getElementById("time");
                              for (var x in dateObject) {
                                monthSel.options[monthSel.options.length] = new Option(x, x);
                              }
                              monthSel.onchange = function() {
                                //empty Chapters- and Topics- dropdowns
                                yearSel.length = 1;
                                daySel.length = 1;
                                //display correct values
                                for (var y in dateObject[this.value]) {
                                    daySel.options[daySel.options.length] = new Option(y, y);
                                }
                              }
                              daySel.onchange = function() {
                                //empty Chapters dropdown
                                yearSel.length = 1;
                                //display correct values
                                var z = dateObject[monthSel.value][this.value];
                                for (var i = 0; i < z.length; i++) {
                                    yearSel.options[yearSel.options.length] = new Option(z[i], z[i]);
                                }
                              }
                            
                              yearSel.onchange = function(){
                                    timeSel.length = 1;
                                    for(var x in timeObject){
                                        timeSel.options[timeSel.options.length] = new Option(x, x);
                                    }
                                }
                            }

                            function setBudget(){
                              // Get the checkbox
                              var checkBox = document.getElementById("budgetMode");

                              // If the checkbox is checked, display the output text
                              if (checkBox.checked == true){
                                document.getElementById("settings").style.display = "none";
                                document.getElementById("budgetSettings").style.display = "block";
                              } else {
                                document.getElementById("budgetSettings").style.display = "none";
                                document.getElementById("settings").style.display = "block";
                              }
                            }

                            function newJob(){
                              var checkBox = document.getElementById("budgetMode");
                              if (checkBox.checked == true){
                                document.getElementById("list").innerHTML += "<br><li>"+month.value+" "+ day.value+" "+year.value+" "+time.value+ "<br> Max Temp: "+document.getElementById("maxTemp").value+ "&#176;, Min Temp: "+document.getElementById("minTemp").value+ "&#176;, Threshold Temp: "+document.getElementById("threshTemp").value + "&#176;</li>";
                              }
                              else{
                                document.getElementById("list").innerHTML += "<br><li>"+month.value+" "+ day.value+" "+year.value+" "+time.value+"<br> Temperature: "+ document.getElementById("temp").value + "&#176;</li>";
                              }
                            }



                            function scheduleFunction(){
								var thresh = document.getElementById("threshTemp").value;
								var min = document.getElementById("minTemp").value;
								var max = document.getElementById("maxTemp").value;
								var temp = document.getElementById("temp").value;
								var checkBox = document.getElementById("budgetMode");
								var budgetInfo = "{\"temperatures\":["
										+ thresh
										+ ", " + min
										+ ", " + max
										+ "], \"is_budget\":"
										+ checkBox.checked
										+ "}";
								var regInfo = "{\"temperatures\":["
										+ temp
										+ ", " + 0
										+ ", " + 0
										+ "], \"is_budget\":"
										+ checkBox.checked
										+ "}";
                                //var budgetInfo = {"temperatures":["maxTemp","minTemp","threshTemp"]}; 
                                //var regInfo = {"temperature": ["temp"]};
								if ((checkBox.checked && thresh != '' && min != '' && max != '') || (!checkBox.checked && temp != '')) {
									var request = new XMLHttpRequest();
									request.open('POST','http://sabernet.ddns.net:8080/api/devices/9be0a1cf-d7d9-48f4-9122-26a8e295cae3/schedules', false);
									request.setRequestHeader('Authorization', 'Basic QWRtaW46cSVtIj1mSihWWSIjQnBMSDQ4fjspPkB1UWhnN2paNUA=');
									if (checkBox.checked == true){
										request.send(budgetInfo);
									}
									else{
										request.send(regInfo);
									}
									alert("Settings Updated!");
								}
                            }

                            function CurrentTemperature() {
                                var request = new XMLHttpRequest();
                                request.open('GET','http://sabernet.ddns.net:8080/api/devices/9be0a1cf-d7d9-48f4-9122-26a8e295cae3/schedules', false);
                                request.setRequestHeader('Authorization', 'Basic QWRtaW46cSVtIj1mSihWWSIjQnBMSDQ4fjspPkB1UWhnN2paNUA=');
                                request.send();

                                var currentTemp = null;
                                var currentMode = null;
                                if (request.response == null) {
                                    document.getElementById("currentTemp").innerHTML = currentTemp;
                                } else {
                                    var obj = JSON.parse(request.response);
                                    currentTemp = obj.temperature;
                                    currentMode = obj.mode;
                                    document.getElementById("currentTemp").innerHTML = currentTemp;
                                    document.getElementById("currentMode").innerHTML = currentMode;
                                }
                            }

                            </script>


</body>
</html>
